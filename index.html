<head>
<noscript><style>.jsonly {display:none}</style></noscript>
<script src="funcs_pure.js"></script>
<script src="post.js"></script>
</head>
</body>
<h1 id="title-here">Title Here</h1>

<p>This is a collection of javascript code snippets that perform external page requests and report their success or failure, for use with client browser security tests. In most cases, these tests involve the client making an external page request to a controlled malicious/insecure server that exhibits the vulnerability in question. A secure browser will block the response, whereas an insecure browser will not. Hence, if the requested resource is successfully loaded, a browser instance is proven to be insecure. </p>



<h2 id="objective">Objective</h2>

<p>To explore the different methods of performing and detecting the success or failure of an external page load, and to develop an efficient, concise, and general method to do so. </p>



<h2 id="methods">Methods</h2>

<p>There are several different methods to send an external page request, a few of which are represented here. </p>

<ul>
<li><p>Image - The simplest method. An <code>&lt;img&gt;</code> tag is dynamically added to the page, and succes and failure methods are registered to its <code>onload</code> and <code>onfail</code> events respectively.</p></li>
<li><p>CORS - <a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">Cross Origin Resource Sharing</a> is a Same-Origin-Policy workaround feature present in practically every modern browser (<a href="http://caniuse.com/#feat=cors">with the exception of Opera Mini</a>). This snippet simply makes a plain old javascript AJAX request to a server that is <a href="http://enable-cors.org/client.html">configured</a> to share resources with the requesting domain. </p></li>
<li><p>JSONP - <a href="http://json-p.org/"><strong>JSON</strong> with **P**adding</a> is a slightly more hack-y SOP workaround that doesn't requre any overhead and is slightly more ubiquitous than CORS - especially among <a href="https://blog.algolia.com/jsonp-still-mandatory/">older browsers</a>. A pretty good explanation of how it works can be found <a href="http://stackoverflow.com/questions/2067472/what-is-jsonp-all-about">here</a>, but the basic idea is this - rather than returning a javascript object, the server will call a callback function in the client's context (specified by the <code>callback</code> query parameter) with the requested resource as the argument to the function. If it feels like a hack, that's because it is one.</p></li>
<li><p>jQuery Shorthand - These last three methods are all <a href="http://api.jquery.com/category/ajax/shorthand-methods/">jQuery shorthand</a> for different types of AJAX requests. They also use CORS and JSONP, but they push those methods a little bit further. They vary in their core method - either CORS or JSONP - and the type of resouce being requested.</p>

<ul><li><a href="http://api.jquery.com/load/">$.load()</a> - asynchronously requests an html resource, in this case from a CORS enabled endpoint.</li>
<li><a href="https://api.jquery.com/jquery.getscript/">$.getScript()</a> - asynchronously requests a javascript resource, also from a CORS enabled endpoint.</li>
<li><a href="http://api.jquery.com/jquery.getjson/">$.getJSON()</a> - asynchronously makes a JSONP request to a JSONP configured endpoint.</li></ul></li>
</ul>



<h2 id="testing">Testing</h2>

<p>The objective of a client test site is to accurately either alert clients of their vulnerability or reassure them of their security. Therefore, we sought to find the most reliable and concise method or set of methods to use when making external page requests such that we can provide a reliabe assessment of the client's security. </p>

<p>To do so, we utilized <a href="http://www.browserstack.com/">Browserstack</a> - a live and automated browser testing tool. Over 700 different OS/Browser combinations were automated to load a page which tested each of the methods against two different endpoints - one insecure endpoint serving a self signed certificate and supporting vulnerable and cracked ciphers, and an endpoint serving simple http. </p>

<p>The expected behavior was for the browser to allow all responses from the http endpoint and block responses from the https endpoint. </p>



<h2 id="coverage-and-analysis">Coverage and Analysis</h2>

<p>Initially, looking at the results it seemed as though there was a rather large set of browser/OS combinations that failed to block the responses from the insecure server. However, they were nearly all instances of Google Chrome and it was strange for all errors to exist in only one browser. It turns out that Browserstack turns off security features for most automated Chrome instances, and they don't allow you to turn them back on. This is done to avoid hiccups in the more common use cases of their service that could be caused by lazy or delayed security configuration. Unfortunately this necessitated a rather time consuming workaround - each version that had this problem had to be double checked by starting an instance manually. In the end, all of these browser/OS combinations successfully blocked the insecure responses. </p>

<p>The upshot is that, according to the results of this test, any of these methods could be used to test a browser's security by performing an external page request. In the interest of reducing overhead the pure javascript solutions are recommended, especially as they are all practically ubiquitous and well-supported.</p>

<p>After collecting theoretical data using controlled versions of many different browser/OS combinations, it was time to begin testing these methods on browsers in the real world.</p>
<span>
<noscript>
<form id="noscript_form" method="POST" action="http://certifiedtest.me/log" target="_blank">
<input hidden type="text" name="result" value="precheck_fail">
<input type="submit" value="Click Here"> to briefly test your browser's security using these methods! 
</form>
</noscript> 
<div class="jsonly"><button onclick="test_suite(http_url,'http');test_suite(https_url,'https');alert('Thank You!');">Click Here</button>to briefly test your browsers security using these methods! </div>
</span>
<hr>
</body>
